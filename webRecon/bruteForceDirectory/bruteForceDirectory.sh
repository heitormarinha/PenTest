#!/bin/bash

#Defining paths
directories="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/directoryList.txt"
directoriesFound="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/directoriesFound.txt"
extensions="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/extensions.txt"

<<temp
#Getting input.
echo "Type the domain target: "
read domain
echo "Define the user agent:"
read HostUserAgent
temp

domain="businesscorp.com.br"
HostUserAgent="mozila"

#Loop with only file name, so without extension.
for directory in $(cat $directories);
do
    #-H host source user agent  -s silent mode, -o output to null, - write %{} variable in CURL module and the last full path domain
    response=$(curl -s -H "User-Agent: $HostUserAgent" -o /dev/null -w "%{http-code}" $domain/$directory/)
    if [  $response == 200  ]
    then
        echo "Directory found: $directory" >> $directoriesFound
    fi
done

#Loop with file.extension.
for directory in $(cat $directories);
do
    for extension in $(cat $extensions);
    do
        #-H host source user agent  -s silent mode, -0 output to null, - write %{} variable in CURL module and the last full path domain
        response=$(curl -H "User-Agent: $HostUserAgent" -s -o /dev/null -w "%{http-code}" $domain/$directory$extension)
        if [  $response == 200  ]
        then
            echo "Directory found: $directory" >> $directoriesFound
        fi
    done
done

cat $directoriesFound | sort -u > $directoriesFound