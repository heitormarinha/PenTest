#!/bin/bash

#Declaring lists.
nationalList="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/nacionalDirectoryLIst.txt"
foreginlLists="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/multinacionalDirectoryLIst.txt"
multiNacionalList="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory//home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/directoryList.txt"

#Defining paths
directories=$nationalList#Setting the region of list.
directoriesFound="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/directoriesFound.txt"
extensions="/home/heitor/Documents/PenTest/webRecon/bruteForceDirectory/extensions.txt"

#These fields need be setted.
domain="businesscorp.com.br"
HostUserAgent="mozila"

#Loop with only file name, so without extension.
for directory in $(cat $directories);
do
    #-H host source user agent  -s silent mode, -o output to null, - write %{} variable in CURL module and the last full path domain
    response=$(curl -s -H "User-Agent: $HostUserAgent" -o /dev/null -w "%{http_code}" "$domain/$directory/")
    if [  $response == "^2*"  ]
    then
        echo "Directory found: $directory" >> $directoriesFound
    fi
done

#Loop with file.extension.
for directory in $(cat $directories);
do
    for extension in $(cat $extensions);
    do
        #-H host source user agent  -s silent mode, -0 output to null, - write %{} variable in CURL module and the last full path domain
        response=$(curl -H "User-Agent: $HostUserAgent" -s -o /dev/null -w "%{http_code}" $domain/$directory$extension)
        if [  $response == "^2*"  ]
        then
            echo "Directory found: $directory" >> $directoriesFound
        fi
    done
done

cat $directoriesFound | sort -u > $directoriesFound