#!/bin/bash

#Importing modules.
source /home/heitor/Documents/PenTest/modules/bash/bash.sh

#Black box.
#Filtering the host and port what are launching the NetBIOS service.
for line in $(cat $hostsWithOpenedTCPPortsExtern | grep "*netbios*" | sed $regexRemoveWhiteSpace):
do
    domain=$(echo $line | grep -o $regexGetIP)
    port=$(echo $line | grep -o $regexGetPortOfHTTPSServiceNmapOutPutGrepbleList | cut -d "/" -f 1)
    echo "$domain $port" >> $enumerationNetBIOSAndSMBExtern
done
#Filtering the host and port what are launching the SMB service.
for line in $(cat $hostsWithOpenedTCPPortsExtern | grep "*smb*" | sed $regexRemoveWhiteSpace):
do
    domain=$(echo $line | grep -o $regexGetIP)
    port=$(echo $line | grep -o $regexGetPortOfHTTPSServiceNmapOutPutGrepbleList | cut -d "/" -f 1)
    echo "$domain $port" >> $enumerationNetBIOSAndSMBExtern
done
