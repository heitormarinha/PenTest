#!/bin/bash

pathBruteForceDNS="/home/heitor/Documents/PenTest/DNS/bruteForceDNS/subdomainsFound.txt"
pathBruteForceDNSReverse="/home/heitor/Documents/PenTest/DNS/bruteForceDNS/subdomainFoundReverse.txt"
pathSenderPolicyFramework="/home/heitor/Documents/PenTest/DNS/senderPolicyFramework"

#List of subdomainsFound of brute force DNS.
for subdomain in $(cat $pathBruteForceDNS);
do
    host -t txt $subdomain | egrep -v "NXDOMAIN|-all" >> $pathSenderPolicyFramework/subdomainsWithVulnerability.txt #-all is recomended SPF 
done

#List found of brute force of reverse DNS.
for subdomain in $(cat $pathBruteForceDNSReverse | sed 's/.$//');
do
    host -t txt $subdomain  | egrep -v "NXDOMAIN|-all" >> $pathSenderPolicyFramework/subdomainsWithVulnerability.txt #-all is recomended SPF 
done

cat $pathSenderPolicyFramework/subdomainsWithVulnerability.txt | sort