#!/bin/bash

#Importing regex file.
source /home/heitor/Documents/PenTest/modules/bash/regex.sh

#! Bash script fetures
keyword="" #content string
OS=1 #1 for Windows 0 for Linux
AS="" #Got for whois tool
payloadDomain="" #Need be setted.
payloadPort="" #Need be setted
protocol="smb" #server menseger block default port 445
nameOfInterface="eth0"
domainControler="" #ipAdress or hostname
domainOrWorkgroupName="orionscorp2"

#!Nmap resources.
#Specifying target hosts and networks extern.
domain="businesscorp.com.br"
cidr="" # A number bit IP/<number>
ipRange="224-239"  
ipAddress="37.59.174.225" #got for host $domain command.
staticIP="37.59.174" #value found in whois tool.
hostUserAgent="mozila"

#Specifying target hosts and networks intern.
hostname="businesscorp.com.br"
cidrIntern="24" # A number bit IP/<number>
ipRangeIntern="<value>"  
ipNetowork="172.16.1.0"
ipAddressIntern="172.16.1.x" 
staticIPIntern="172.16.1"

#Inputs.
inputFromList="-iL <path of file>" #path the file -iL <path>
exclude="--exclude <IP> " #is the literal > --exclude <IP>
excudeFile="--excludefile <path of file>"

#Outputs formats.
totalInformation="-v -d<number>" #verbose and debug information
outputNormal="-oN"
outputGrepable="-oG"
outputXML="-oX"
outputAllFormat="-oA"
appendOutput="--append-output"

#DNS resolution.
noResolutionDNS="-n"
resolutionDNS="-R"
dnsServers="--dns-servers <seerver or <path>>"

#Hosts discovery controls (ping sweep).
enumeratingHosts="-sL $domain/$cidr" #This command dont send packet to the target.
pingScan="-sP" #Scannig ping
pingTCPSYN="-PS -F" #Also can be -PS <port range>, <port>,<port...>
pingTCPACK="-PA -F" #Also can be -PA <port range>
pingUDP="-PU -F" #The prob for a unsed port is interesting. this use the answwer to know whether the host is  up or down.
pingEchoRequest="-PE -F" #ICMP - type 8
pingTmestamp="-PP -F" #ICMP - code 14
pingMask="-PM -F" #ICNMP code 18 
pingProtocol="-PO -F" #
pingARP="-PR $ipAddress"
pingNot="-PN"
ipVersion6="-6" 
packetTtrace="--packet-trace"
reason="--reason"
dataLength="--data-length <>" #value 32 look like Windows and 56 simulats the Linux.
sendIP="--send-ip <>"
sendEthernet="-- send-ethernet <ipAddress>"
timeToLive="--time <number>" #
timeTemplate="-T4" #Recomended.
maxParallelism="--max-parallelism <number>"
minParallelism="--min-parallelism <number>"
maxRoundTripTime="--max-rtt-timeout 200"
minRoundTripTime="--min-rtt-timeout <number>"
initialRoundTripTime="--initial-rtt-timeout 150"
decoy="-D RND:20"
ipSource="-S 187.29.158.131"
ipEnd="-e <ipaddress>"

#Port / services discovery (por scan).
ports="-p-"
portScanSYN="-sS"
portScanConnect="-sT"
portScanFIN="-sF"
portScanXmas="-sX"
portScanNull="-sN"
portScanACK="-sA" #Handle the rules of firewall.
portScanPush="-sP"
portWindows="-sW" #Got th e rules of firewall and return some open/close
porScanMaimom="-sM"
portScanIdle="-sI"
portScanVersion="-A" #or -A
portScanProtocol="-sO" #Determine which protocol are suported (TCP,UDP and ICM IGMP).
portScanUDP="-sU"
fastScan="-F" # Scannign the top 100 most commun ports instead of 1000.
hostTimeOut="--host-timeout <number>"
maxRate="--max-rate <number>"
minRate="--min-rate <number>"
maxRetries="--max-retries <number>"
maxHostGroup="--max-hostgroup <number>"
minHostGroup="--min-hostgroup 512"
scanDelay="--scan-delay <number>"
maxScanDelay="--max-scan-delay <number>"
portStatus="--open" #--open, -
scanFlags="--scanflags <flas or numbers>" #eg: SYNFYN 
versionIntensity="--version-intensity 9"
portScanPerfomanceSetting="$maxRoundTripTime $initialRoundTripTime $minHostGroup"

#OS Discovery
osDetection="-O"
osScanLimit="--osscan-limit"
osMaxScan="--max-os-tries 1" # Best pratiace.
osMinScan=""

#!Statics lists paths.
nationalSubdomainsNamesFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/subdomains/nationalSubdomainsNames.txt"
foreginSubdomainsNamesFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/subdomains/foreginSubdomainsNames.txt"
subdomains="/home/heitor/Documents/PenTest/lists/StaticListToFilter/subdomains/multinationalSubdomainsNames.txt"
fileExtensionsListFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/fileExtensionsList.txt"
nationalFeaturesWebsURLFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/featuresWebsite/nationalFeaturesWebsiteURLs.txt"
foreginFeaturesWebsiteURLsFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/featuresWebsite/foreginFeaturesWebsiteURLs.txt"
multinationalFeaturesWebsiteURLFile="path"
communitySNMPList="/home/heitor/Documents/PenTest/lists/StaticListToFilter/wordlistCommonSNMPCcommunityStrings.txt"

#!Generated lists by code paths.
subdomainsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/subdomains/subdomainsFound.txt"
subdomainsFoundReverseFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/subdomains/subdomainsFoundReverse.txt"
mergingSubdomainsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/subdomains/mergingSubdomainsFound.txt"
subdomainsWithVulnerabilitySPFFIle="/home/heitor/Documents/PenTest/lists/generatedListsByCode/subdomains/subdomainsWithVulnerabilitySPF.txt"
ListOfDomainsPointedForCNAMEFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/subdomains/ListOfDomainsPointedForCNAME.txt"
zoneTransferHandledFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/subdomains/zoneTransferHandled.txt"
featuresWebsiteFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/featuresWebsite/featuresWebsite.txt"
whatwebInformationFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/whatwebInformation/whatwebInformation.txt"

#!Output of scanning  paths.
#Black box.
ipHostsFoundFileExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundExtern/ipHostsFoundExtern.txt"
hostsWithOpenedTCPPortsExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundExtern/hostsWithOpenedTCPPortsExtern.txt"
hostsWithOpenedUDPPortsExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundExtern/hostsWithOpenedUDPPortsExtern.txt"
hostsWithOpenedPortsAndBannerExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundExtern/hostsWithOpenedPortsAndBannerExtern.txt"
hostsOSExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundExtern/hostsOSExtern.txt"

#White box.
ipHostsFoundFileIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/ipHostsFoundIntern.txt"
arpHostsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/arpHostsFound.txt"
hostsWithOpenedTCPPortsIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/hostsWithOpenedTCPPortsIntern.txt"
hostsWithOpenedUDPPortsIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/hostsWithOpenedUDPPortsIntern.txt"
hostsWithOpenedPortsAndBannerIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/hostsWithOpenedPortsAndBannerIntern.txt"
hostsOSIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/hostsOSIntern.txt"
hostsProWithFullInfoIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/hostsProWithFullInfoIntern.txt"

#!Enumarations' output paths 
#black box.
enumetationHostsHTTPExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumetationHostsHTTPExtern.txt"
enumetationHostsHTTPSExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumetationHostsHTTPSExtern.txt"
enumetationHostsMysqlExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumetationHostsMysqlExtern.txt"
enumetationHostsFTPExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumetationHostsFTPExtern.txt"
enumerationNetBIOSAndSMBExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumerationNetBIOSAndSMBExtern.txt"
enumerationPOP3Extern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumerationPOP3Extern.txt"
enumerationSMTPExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumerationSMTPExtern.txt"
enumerationTelnetExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundExtern/enumerationTelnetExtern.txt"
enumerationSSHtExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumerationSSHtExtern.txt"
enumerationNFStExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumerationNFSExtern.txt"
enumerationSNMPExtern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationExternLists/enumerationHostsInfoSNMP.txt"

#White box.
enumetationHostsHTTPIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumetationHostsHTTPIntern.txt"
enumetationHostsHTTPSIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumetationHostsHTTPSIntern.txt"
enumetationHostsMysqlIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumetationHostsMysqlIntern.txt"
enumetationHostsFTPIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumetationHostsFTPIntern.txt"
enumerationNetBIOSAndSMBIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumerationNetBIOSAndSMBIntern.txt"
enumerationPOP3Intern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumerationPOP3Intern.txt"
enumerationSMTPIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumerationSMTPIntern.txt"
enumerationTelnetIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/hostsFoundIntern/enumerationTelnetIntern.txt"
enumerationSSHtIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumerationSSHtIntern.txt"
enumerationNFStIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumerationNFSIntern.txt"
enumerationSNMPIntern="/home/heitor/Documents/PenTest/lists/generatedListsByCode/enumarationInternLists/enumerationHostsInfoSNMPIntern.txt"

#TODO path of information of services. Black box
#HTTP
#*The path of file is python module.
#HTTPS
#*The path of file is python module.
#FTP
#*The path of file is python module.
#SSH
#*None, need itaration.
#NetBIOS/smb
enumerationHostInfoNetBIOSAndSMBExtern="/home/heitor/Documents/PenTest/enumeration/enumerationNetBIOSANDSMB/enumerationHostInfoNetBIOSAndSMBExtern.txt"
#POP3
#*None, need itaration.
#SMTP
#*None, need itaration.
#SNMP
enumerationHostsInfoSNMPExtern="/home/heitor/Documents/PenTest/enumeration/enumerationSNMPExtern/hostsInfo.txt"

#!Hashes
stringsOrFiles="/home/heitor/Documents/PenTest/temp" #need be defined and the value can be literal string , arrray of literal srting or file. (hash without $)
typeOFDecrypt="md5sum" #md5sum, sha<number>sum
appHash="$typeOFDecrypt pathOfFile" # Can a literal string.
hashFile="/home/heitor/Documents/PenTest/pentestIntern/hashFile.txt" #TODO command is: 
$typeOFDecrypt "md5sum"
wordList="/usr/share/wordlists/rockyou.txt.gz"
numberofDecryptTecnogy="2100" #500 md5 linux, 5600 NetNTLMv2 400 WordExpress, 2100 DCC domain control cash v2

#? Logs. Blue Team
intruder="177.138.28.7" #Got by intruderHandler
log="/home/heitor/Documents/PenTest/logAnalyzer/access.log"
firstAttack="13/Feb/2015:00:21:12" #Got for the handleTheFistAndLastAtack
lastAttack="13/Feb/2015:08:58:35" #handleTheFistAndLastAtack
pcap=""

