#!/bin/bash

#!Nmap Red team.
#Specifying target hosts and networks extern.
domain="businesscorp.com.br"
cidr="" # A number bit IP/<number>
ipRange="224-239"  
ipAddress="37.59.174.225" #got for host $domain command.
staticIP="37.59.174" #value found in whois tool.
hostUserAgent="mozila"

#Specifying target hosts and networks extern.
hostname="businesscorp.com.br"
cidrIntern="24" # A number bit IP/<number>
ipRangeIntern="<value>"  
ipAddressIntern="172.16.1.0" #got for host $domain command.
staticIPIntern="172.16.1" #value found in whois tool.

#Inputs.
inputFromList="-iL <path of file>" #path the file -iL <path>
exclude="--exclude <IP> " #is the literal > --exclude <IP>
excudeFile="--excludefile <path of file>"

#Outputs formats.
totalInformation="-v -d<number>" #verbose and debug information
outputNormal="-oN"
outputGrepable="-oG"
outputXML="-oX"
outputAllFormat="-oA"
appendOutput="--append-output"


#DNS resolution.
noResolutionDNS="-n"
resolutionDNS="-R"
dnsServers="--dns-servers <seerver or <path>>"

#Hosts discovery controls (ping sweep).
enumeratingHosts="-sL $domain/$cidr" #This command dont send packet to the target.
pingScan="-sP" #Scannig ping
pingTCPSYN="-PS -F" #Also can be -PS <port range>, <port>,<port...>
pingTCPACK="-PA -F" #Also can be -PA <port range>
pingUDP="-PU -F" #The prob for a unsed port is interesting. this use the answwer to know whether the host is  up or down.
pingEchoRequest="-PE -F" #ICMP - type 8
pingTmestamp="-PP -F" #ICMP - code 14
pingMask="-PM -F" #ICNMP code 18 
pingProtocol="-PO -F" #
pingARP="-PR $ipAddress"
pingNot="-PN"
ipVersion6="-6" 
packetTtrace="--packet-trace"
reason="--reason"
dataLength="--data-length <>" #value 32 look like Windows and 56 simulats the Linux.
sendIP="--send-ip <>"
sendEthernet="-- send-ethernet <ipAddress>"
timeToLive="--time <number>" #
timeTemplate="-T4" #Recomended.
maxParallelism="--max-parallelism <number>"
minParallelism="--min-parallelism <number>"
maxRoundTripTime="--max-rtt-timeout 200"
minRoundTripTime="--min-rtt-timeout <number>"
initialRoundTripTime="--initial-rtt-timeout 150"
decoy="-D RND:10"
ipSource="-S 187.29.158.131"
ipEnd="-e <ipaddress>"

#Port / services discovery (por scan).
portScanSYN="-sS"
portScanConnect="-sT"
portScanFIN="-sF"
portScanXmas="-sX"
portScanNull="-sN"
portScanACK="-sA" #Handle the rules of firewall.
portScanPush="-sP"
portWindows="-sW" #Got th e rules of firewall and return some open/close
porScanMaimom="-sM"
portScanIdle="-sI"
portScanVersion="-A" #or -A
portScanProtocol="-sO" #Determine which protocol are suported (TCP,UDP and ICM IGMP).
portScanUDP="-sU"
fastScan="-F" # Scannign the top 100 most commun ports instead of 1000.
hostTimeOut="--host-timeout <number>"
maxRate="--max-rate <number>"
minRate="--min-rate <number>"
maxRetries="--max-retries <number>"
maxHostGroup="--max-hostgroup <number>"
minHostGroup="--min-hostgroup 512"
scanDelay="--scan-delay <number>"
maxScanDelay="--max-scan-delay <number>"
portStatus="--open" #--open, -
scanFlags="--scanflags <flas or numbers>" #eg: SYNFYN 
versionIntensity="--version-intensity 9"
portScanPerfomanceSetting="$maxRoundTripTime $initialRoundTripTime $minHostGroup"

#OS Discovery
osDetection="-O"
osScanLimit="--osscan-limit"
osMaxScan="--max-os-tries 1" # Best pratiace.
osMinScan=""

#...
keyword="" #content string
OS=1 #1 for Windows 0 for Linux
AS="" #Got for whois tool
payloadDomain="" #Need be setted.
payloadPort="" #Need be setted

#!Statics lists.
nationalSubdomainsNamesFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/subdomains/nationalSubdomainsNames.txt"
foreginSubdomainsNamesFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/subdomains/foreginSubdomainsNames.txt"
subdomains="/home/heitor/Documents/PenTest/lists/StaticListToFilter/subdomains/multinationalSubdomainsNames.txt"
fileExtensionsListFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/fileExtensionsList.txt"
nationalFeaturesWebsURLFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/featuresWebsite/nationalFeaturesWebsiteURLs.txt"
foreginFeaturesWebsiteURLsFile="/home/heitor/Documents/PenTest/lists/staticListToFilter/featuresWebsite/foreginFeaturesWebsiteURLs.txt"
multinationalFeaturesWebsiteURLFile="path"

#!Generated lists.
subdomainsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/subdomains/subdomainsFound.txt"
subdomainsFoundReverseFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/subdomains/subdomainsFoundReverse.txt"
mergingSubdomainsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/subdomains/mergingSubdomainsFound.txt"
subdomainsWithVulnerabilitySPFFIle="/home/heitor/Documents/PenTest/lists/generatedListsForCode/subdomains/subdomainsWithVulnerabilitySPF.txt"
ListOfDomainsPointedForCNAMEFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/subdomains/ListOfDomainsPointedForCNAME.txt"
zoneTransferHandledFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/subdomains/zoneTransferHandled.txt"
featuresWebsiteFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/featuresWebsite/featuresWebsite.txt"
whatwebInformationFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/whatwebInformation/whatwebInformation.txt"
ipHostsFoundFileExtern="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFoundExtern/ipHostsFoundExtern.txt"
ipHostsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFound/ipHostsFound.txt"
arpHostsFoundFile="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFound/arpHostsFound.txt"
hostsWithOpenedTCPPortsExtern="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFoundExtern/hostsWithOpenedTCPPortsExtern.txt"
hostsWithOpenedUDPPortsExtern="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFoundExtern/hostsWithOpenedUDPPortsExtern.txt"
hostsWithOpenedPortsAndBannerExtern="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFoundExtern/hostsWithOpenedPortsAndBannerExtern.txt"
hostsOSExtern="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFoundExtern/hostsOSExtern.txt"
hostsOS="/home/heitor/Documents/PenTest/lists/generatedListsForCode/hostsFound/hostsOS.txt"



#? Logs. Blue Team
intruder="177.138.28.7" #Got by intruderHandler
log="/home/heitor/Documents/PenTest/logAnalyzer/access.log"
firstAttack="13/Feb/2015:00:21:12" #Got for the handleTheFistAndLastAtack
lastAttack="13/Feb/2015:08:58:35" #handleTheFistAndLastAtack
pcap=""

